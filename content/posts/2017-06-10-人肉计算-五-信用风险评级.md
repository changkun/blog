---
date: 2017-06-10 19:51:28
id: 230
path: source/_posts/2017-06-10-人肉计算-五-信用风险评级.md
tags:
  - 人肉计算
  - 金融
  - 信用风险评级
title: '人肉计算(5): 信用风险评级模型'
---

上一篇文章我们简单「水」过了已经耳熟能详的 PageRank。这里简单总结一下：

- 一个社交网络其实就是一个矩阵；
- 如果这个社交网络是一个加权有向图，那么通过 PageRank 算法可以根据边的权值和流向确定网络中节点的重要性排名；
- 排名最高者就是特征向量中心，这个节点在整个网络中的地位最为重要。

这一篇文章我们来真正看看输入数据聚合的实际例子，如何将人肉计算应用到信用风险评级当中。
本文讨论内容基于这篇文章[^1]，但在谈论具体的模型之前，我们需要铺垫一些金融学知识，首先就是：什么是信用风险评级？它有什么问题？

<!--more-->

## 信用风险评级问题

信用风险评级（Credit Risk Rating）

- 对于金融市场至关重要
- 是基于风险的资本准则或「资本需求」，目标是避免银行的倒闭
- 目前形式困难的原因是伴随着衍生品、结构化票据和证券化的某些情况下是不可能的实现的

在这些工具和技术存在的情况下，广泛的不当信用评级被认为是 2007 至 2009 年金融危机爆发的主要原因，它引发了：

- 大衰退
- 欧洲主权债务危机
- 经济衰退仍然在影响一些国家

信用风险（Credit risk）是金融的风险代理（如银行）将根据金融合约不会归还钱（如抵押贷款）。

在金融市场上的信用风险评级是至关重要的原因有：

- 金融资产的价值取决于这些资产相关的风险
- 承担太多的风险导致破产
- 金融机构预计将减少信贷风险，也就是说转达他们的债权人不如他们自己面临信用风险

## 衍生品合约

衍生品是指从原生品种派生出来的事务，金融衍生品则是从基础的金融产品中派生出来的交易形态。

当衍生品合约（Derivative Contracts，简称衍生品 Derivative）被输入时，在合同期间的大部分期间，合约方之间的货币流动方向未明确。

与衍生品合约相反，信用合约（如抵押）：

- 充分规定合约方之间的流动资金
- 对于其中一个合约方不承担任何风险

注意：

- 「债务人」（debtor）用来代替「实际或潜在的债务人」，借方，还钱方
- 「债权人」（creditor）用来代替「实际或潜在的债权人」，贷方，借钱方

衍生品的例子：

- 期货（future）是以合同生效时间指定的价格在未来日期前或之前购买或出售资产的合同，是一种跨越时间的交易方式。
- 期权（option）是一种合同，给予其所有者在未来某个时候买入或卖出资产（通常是股票、债券、货币或未来）的权利。
- 互换（swap）是互换在一段时间内，通常是15年，现金流的金融工具的一方对另一方的金融工具。
- 使用信用违约互换（credit default swaps, CDS） 和或有信用违约互换（contingent credit default swaps）的交换现金流取决于「信用事件」（如资本重组、破产，如果代理人的信用评级被降级），与交换所依据的两种金融工具无关。
- 衍生品的平方（squared derivative）是一个衍生品的衍生品。

各方之间的风险转移，例如通过衍生工具，由于具有比较优势的规律，可能是有意义的。

- 比较优势（Law of comparative advantages）：代理人比另一代理人更低的边际和机会成本生产好的或服务的能力。
- 绝对优势：只考虑一个产品的生产优势。
- 边际成本（Marginal cost）：生产一个单位的成本或服务的成本。边际成本和边际收入相等时，利益最大化。
- 机会成本（Opportunity cost）：通过尽可能的生产选择来生产良好的服务的成本。

## 当前信用风险评级存在的问题

当前的信用风险评级是基于随机方法和统计数据的。

因此，目前的信用风险评级本质上是不准确的，如果：

- 某些特殊情况下，例如市场危机和泡沫；
- 没有统计数据的新型合约。

目前的信用风险评级具有道德风险：

- 由银行执行，显示其财务状况的证据；
- 由信用评级机构代表（通常很昂贵），由需要良好评级的债务人在良好条件下被授予信用来执行。

金融交易与当前信用风险评级有很大差距：

- 高频股票交易自动反应指数变化是以秒计算的；
- 目前的信用风险评级是由人类最好每周最坏每年的周期重新计算的

目前的信用风险评级远远不可靠：

- 没有信用评级机构在 2008 年崩溃之前将投资银行 Bear Stearn 降级，这是2007 - 2009 年金融危机的前奏；
- 类似的例子比比皆是。

为了解决这些问题，我们给出基于人肉计算和网络分析的信用风险评估方法：

- 代理人的信用风险形式化
- 人肉计算：潜在的债务人评估自己的违约风险
- 网络分析：将人力资源估计纳入信用风险评级

## 信用风险的形式化

代理 $i$ 在未来时间 $t$ 的信用风险为：

$$
CR^{t}(i) = \sum_{j} (w_{ji}^t \times c_{ji}^t)
$$

其中：

- $w_{ji}^t$ 表示在时间 t 时，j 拖欠到 i 的似然值
- $c_{ji}^t$ 表示在时间 t 时，j 对于代理 i 的应付款

为了将人肉计算应用到这个模型当中，我们需要针对 $w_{ji}^t$ 来解释什么是宽限期奖励。

## 宽限期奖励

对于面临可能违约的代理人，时间可以追回未偿还的债务或信用，因此在某些情况下可以防止违约。

对于宽限期奖励（Grace Period Reward, GPR）来说：

- 功能像信用违约保险
- 但仅限于有限时间段内，也就是所谓的「宽限期」
- 并且所有代理人的成本相同

因此，GPR：

- 不是保险
- 不会像保险一样产生道德风险

GPR 由债务人激活：

- 任何时间 $t$ 都能作为期权的开始的时刻 $t_1 \geq t$
- 对于任何未支付的报酬（百分比）
- 激活成本取决于：覆盖范围、覆盖的未付款项、覆盖持续期

一旦激活代理债务，GPR 可以随时被代理人停用。
通过强制性存款激活金融合同，当 GPR 没有被激活时违约会出现损失。

现在来划重点了。

GPR 在时刻 t 开始被一个代理激活，在时刻 $t_1$ 时有以下观点：

- 在时刻 $t_1$ 或之后，债务人可能会违约，从而这个债务的支付本金或利息；
- 违约的似然值是 $x%$。

换句话说：在 $[t, t_1]$ 这段时间内，债务人可能违约，违约的可能性是 $x%$。

## 建模：信用风险评估作为特征向量中心

现在我们回过头来看信用风险的形式化公式。代理人 $i$ 在时间 $t$ 时的信用风险为：

$$
CR^{t}(i) = \sum_{j} (w_{ji}^t \times c_{ji}^t)
$$

其中：

- $j$ 是 $i$ 的（潜在）潜在债务人;
- $w_{ji}^t \in [0, 1]$ 指在时间 t 时，$j$ 对 $i$ 来说，违约的似然值，由 GPR 提供；
- $c_{ji}^t$ 指在时间 t 时，$j$ 对 $i$ 来说的到期应付款，由金融合同提供。

现在我们来看信用风险网络如何构建。

首先，信用风险随货币的流动而流动：

- 信用风险从债务人流向债权人
- 并能延伸到中央银行
- 并从中央银行能回流到所有金融市场中的代理人

2009 年以来的欧洲主权债务危机提供了充分的证据证明这个信用风险的回流是通过货币流动进行的。（在此前的研究中，这个结论并没有被指出）

### 构建信用风险网络

根据上面的讨论，我们有信用风险网络（Credit Risk Graph）：

- 每个节点都是市场代理人（包括中央银行）
- 每个边有以下内容标记：
  + 边 $j \overset{w_{ji}^t \times c_{ji}^t}{\underset{t}\rightarrow} i$ 从每个不是中央银行的、且是 代理人 i 的债务人的代理人 j 出发，指向 i。表示了 j 对 i 的信用风险贡献。
  + 边 $b \overset{t}{\underset{C_{i}^{t}+\sum_{k}{c_{ki}^{t}}} \rightarrow} i$ 从中央银行指向每个代理人 i。其中 $C_{i}^{t}$ 表示 i 在时间 t 拥有的现金和现金等价物。

CRG 是一个强连接网络。

于是，信用风险排名作为特征向量中心：

$A^t = (a_{ji}^{t})$：标记后的 CRG 图在时间 t 的邻接矩阵为：

$$
a_{ji}^t = \left\{
\begin{array}{ll}
w_{ji}^t \times c_{ji}^t & 如果 j 不是中央银行，且是 i 在时刻 t 的债务人 \\
C_{i}^{t}+\sum_{k}{c_{ki}^{t}} & 如果 j 是中央银行 \\
0 & 其他 \\
\end{array}
\right.
$$

显然，$A^t$ 是实、非负、对角线元素都是 0 的矩阵。

现在令 $I$ 为与 $A^t$ 相同大小的单位矩阵，则 $A^t+I$ 就是实、非负、且对角线均为 1 的矩阵。

考虑 $A^t+I$ 的原因是我们需要下面的矩阵的 Perron 向量存在。

$B^t = (b_{ji})$：$A^t+I$ 的转置 $(A^t+I)^T$ 的列随机正规化定义如下：

$$
b_{ji}^t = \left\{
\begin{array}{ll}
\frac{a_{ij}^t}{\sum_j{a_{ij}^t}} & \text{if} j \neq i \\
\frac{1}{\sum_j{a_{ij}^t}} & \text{if} j = i \\
\end{array}
\right.
$$

同样，$B^t$ 是实、非负的列随机矩阵（列转移概率矩阵，每一列和为 1）。

显然，根据上面的观察，CRG 存在并且在任何时间 t 都强连接，$B^t$ 不可化简。

比较 $A^t$ 和 $B^t$：

- $A^t$ 的 $a_{ji}^t$ 表示 j 对 i 在时刻 t 的**绝对**贡献
- $B^t$ 的 $a_{ji}^t, j \neq i$ 表示 j 对 i 在时刻 t 的**相对**贡献

现在再考虑信用风险的形式化公式，我们可以使用向量的形式重新表示：

$$
(\vec{cr^t})^T = \vec{1}^T A
$$

其中：

- $\vec{cr^{t}}$ 是时刻 t 的信用风险列向量，第 i 个元素为 $CR^t (i)$
- $\vec{1}$ 是 n 维（n表示金融市场的代理人的数量）单位列向量，所有的分量都是 1

无论 $B$ 的对角元素如何，根据上面的公式，我们有：

$$
\vec{cr^t} = B \vec{1}
$$

## 将信用风险评级转化为特征向量中心性

这个公式启发了下面这个系统性风险评级（Credit Risk Rating, CRR）：

假设 $CRR^t (i)$ 表示 i 在时刻 t 时的「信用风险大小」。
则 i 的信用风险大小应该被视为其债务人 j 在时刻 t，通过 $b_{ji}^t$ 加权后的信用风险大小
的比例，即：

$$
CRR^{t} (i) = \frac{1}{\lambda} \times \sum_{j} {(b_{ij}^t \times CRR^t (j))}
$$

其中 $\lambda$ 为正、实标量。

同样，这个公式可以被写成：

$$
\lambda \vec{crr^t} = B^t \vec{crr^t}
$$

其中 $\vec{crr^t}$ 为时刻 t 时的信用风险评级向量，其中第 i 个分量为 $CRR^t (i)$。

很容易看出，现在这个公式表明了信用风险评级本质上是在求特征向量中心性。

### 合理性证明

$B^t$ 是不可约、实、非负、列随机转移的矩阵，$B^t$ 的每个对角元素都是正的。
根据 Perron-Frobenius 定理[^2] （简单来说，这个网络的 n 次转移过程可以被视为一个马尔科夫过程，这个定理说明马尔科夫过程的最大特征值为 1，最大特征向量被称为 Perron 向量），$\lambda = 1$ 是 $B^t$ 的平凡且严格的主特征值，与之关联的特征向量也就是所谓的（矩阵$B^t$） Perron 向量。

由于 $\lambda = 1$ 是 $B^t$ 的一个平凡特征值，则 $B^t$ 的 Perron 向量是上面方程的唯一非零实向量解。

这使得范数 1 与 $B^t$ 的 Perron 向量是一个可接受的信用风险评级向量。

如果向量 $\vec{u}$ 与 $B^t$ 的 Perron 向量不正交，那么 $B^t$ 对 $\vec{u}$ 的指数序列乘积最终会收敛到 $B^t$ 的 Perron 向量。

这使得计算 $B^t$ 的 Perron 向量可以通过指数迭代的方式来进行计算，从而进行信用评级。

如果恰好向量 $\vec{u}$ 是 Perron 向量的一个正交向量，即便如此，舍入误差也将保证能够收敛到 $B^t$ 的 Perron 向量。

至此，我们完成了对整个模型的合理性描述。

## 结论

本文介绍的这种信用风险评级的方法：

- 从计算上可行
- 需要:
  + 相对于信用风险评级的范式转变
  + 列出所有的金融合同（但不需要正规化的合同）
  + 全新的基础设施

这种利用人肉计算和网络分析的方法可能是避免未来泡沫和金融危机的唯一机会。

## 进一步阅读的参考文献

[^1]: F. Bry: “Human Computation-Enabled Network Analysis for a Systemic Credit Risk Rating”, Handbook of Human Computation, Springer, pp. 215-245, 2013
[^2]: Perron-Frobenius 定理 和 Google PageRank, [https://ccjou.wordpress.com/2009/05/02/google-搜尋引擎使用的矩陣運算/](https://ccjou.wordpress.com/2009/05/02/google-搜尋引擎使用的矩陣運算/)